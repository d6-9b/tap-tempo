!function(){function e(){var e,n=t("Blink"),i=n.classList;return{element:n,tick:function(){i.add("light"),clearTimeout(e),e=setTimeout(function(){i.remove("light")},100)}}}function n(e,n,i,a){function r(e){E=e,D.add("active"),T=setInterval(o,50)}function d(){clearInterval(T),D.remove("active")}function o(){var t=C.getBoundingClientRect(),i=C.offsetWidth*y,r=2*(E.clientX-t.left-i/2);L+=.001*r,L=Math.max(e,Math.min(n,L)),l(),a(L)}function l(){p.nodeValue=Math.floor(L);var e=Math.floor(L%1*100);10>e&&(e="0"+e),s.nodeValue=e}var c="Field",f=t(c+"-label");f.appendChild(u(i+":"));var s=u(""),v=t(c+"-precision");v.appendChild(u(".")),v.appendChild(s);var p=u(""),h=t(c+"-leftArrow");h.appendChild(u("◀"));var m=t(c+"-rightArrow");m.appendChild(u("▶"));var C=t(c+"-value");C.appendChild(p),C.appendChild(v),C.appendChild(h),C.appendChild(m);var g=t(c);g.appendChild(f),g.appendChild(C),g.addEventListener("mousedown",function(e){function n(e){e.preventDefault(),E=e}function t(e){e.preventDefault(),d(),removeEventListener("mousemove",n),removeEventListener("mouseup",t)}e.preventDefault(),M?M=!1:(addEventListener("mousemove",n),addEventListener("mouseup",t),r(e))}),g.addEventListener("touchstart",function(e){e.preventDefault(),M=!0;var n=e.changedTouches[0];w=n.identifier,r(n)}),g.addEventListener("touchmove",function(e){e.preventDefault(),M=!0;for(var n=e.changedTouches,t=0;t<n.length;t++){var i=n[t];if(i.identifier===w){E=i;break}}}),g.addEventListener("touchend",function(e){e.preventDefault(),M=!0;for(var n=e.changedTouches,t=0;t<n.length;t++)n[t].identifier===w&&(w=null,d())});var L,E,T,D=C.classList,M=!1,w=null,y=1;return{element:g,addClass:function(e){g.classList.add(e)},setScale:function(e){y=e},setValue:function(e){L=e,l()}}}function t(e){var n=document.createElement("div");return n.className=e,n}function i(i){function u(){L.tick(),C=setTimeout(u,c),M.muted||i()}function d(){h.setValue(6e4/c)}function o(){m.setValue(c)}var l="MainPanel",c=500,f=1,s=240,v=6e4/s,p=6e4/f,h=n(f,s,"BPM",function(e){c=6e4/e,o()});h.addClass(l+"-bpmField");var m=n(v,p,"MS",function(e){c=e,d()});m.addClass(l+"-intervalField"),o();var C,g,L=e(),E=null,T=[],D=r(function(){var e=Date.now();if(null!==E){var n=e-E;T.push(n),T.length>4&&T.shift();var t=T.reduce(function(e,n){return e+n});c=t/T.length,c=Math.max(v,Math.min(p,c)),d(),o(),clearTimeout(C),u(),clearTimeout(g),g=setTimeout(function(){E=null,T.splice(0)},4*c)}E=e}),M=a(),w=t(l+"-buttons");w.appendChild(L.element),w.appendChild(M.element);var y=t(l+"-center");y.appendChild(h.element),y.appendChild(m.element),y.appendChild(w),y.appendChild(D.element);var S=t(l);return S.appendChild(y),d(),u(),{element:S,resize:function(){var e,n=innerWidth,t=innerHeight;t>n?(e=n/320,480*e>t&&(e=t/480)):(e=n/480,320*e>t&&(e=t/320)),S.style.transform="scale("+e+")",h.setScale(e),m.setScale(e)}}}function a(){function e(){a.nodeValue=c.muted?"UNMUTE":"MUTE"}function n(){c.muted=!c.muted,localStorage.muted=JSON.stringify(c.muted),e(),d.add("active")}function i(){d.remove("active")}var a=u(""),r=t("MuteButton");r.appendChild(a),r.addEventListener("mousedown",function(e){function t(e){e.preventDefault(),i(),removeEventListener("mouseup",t)}e.preventDefault(),o?o=!1:(n(),addEventListener("mouseup",t))}),r.addEventListener("touchstart",function(e){if(e.preventDefault(),o=!0,null===l){var t=e.changedTouches[0];l=t.identifier,n()}}),r.addEventListener("touchend",function(e){e.preventDefault(),o=!0;for(var n=e.changedTouches,t=0;t<n.length;t++)n[t].identifier===l&&(l=null,i())});var d=r.classList,o=!1,l=null,c={element:r,muted:function(){try{return JSON.parse(localStorage.muted)}catch(e){return!1}}()};return e(),c}function r(e){function n(){e(),r.add("active")}function i(){r.remove("active")}var a=t("TapButton");a.appendChild(u("TAP")),a.addEventListener("mousedown",function(e){function t(e){e.preventDefault(),d?d=!1:(i(),removeEventListener("mouseup",t))}e.preventDefault(),d?d=!1:(n(),addEventListener("mouseup",t))}),a.addEventListener("touchstart",function(e){if(e.preventDefault(),d=!0,null===o){var t=e.changedTouches[0];o=t.identifier,n()}}),a.addEventListener("touchend",function(e){e.preventDefault(),d=!0;for(var n=e.changedTouches,t=0;t<n.length;t++)if(n[t].identifier===o){o=null,i();break}});var r=a.classList,d=!1,o=null;return{element:a}}function u(e){return document.createTextNode(e)}!function(){function e(){var e=n.resize;addEventListener("resize",e),e()}!function(){var e=document.createElement("style");e.innerHTML="@font-face {font-family: FreeMono;src: url(fonts/FreeMono.ttf);}",document.head.appendChild(e)}();var n,a=document.body;if(window.AudioContext){var r="Main",d=t(r+"-loading");d.appendChild(u("LOADING"));var o=t(r+"-aligner");a.appendChild(d),a.appendChild(o);var l=new XMLHttpRequest;l.open("get","pulse.ogg"),l.responseType="arraybuffer",l.send(),l.onload=function(){var t,r=new AudioContext;r.decodeAudioData(l.response,function(u){n=i(function(){t&&t.stop(),t=r.createBufferSource(),t.buffer=u,t.connect(r.destination),t.start()}),a.removeChild(d),a.removeChild(o),a.appendChild(n.element),e()})}}else{var c=[];n=i(function(){c.length||c.push(new Audio("pulse.ogg"));var e=c.shift();e.play(),e.addEventListener("ended",function n(){e.removeEventListener("ended",n),c.push(e)})}),a.appendChild(n.element),e()}}()}();